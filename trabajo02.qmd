---
title: "Trabajo02: Elección del viaje de fin de carrera"
author: "Mar Canales"
date: "`r Sys.Date()`"
format:
  typst:
    toc: true
    toc-title: "Índice"
  html: default
---

\newpage

### Enunciado

Este año, nos toca **elegir el destino para nuestro viaje de fin de carrera**, una decisión que implica considerar múltiples factores, tanto económicos como organizativos y personales.

Dado que se han propuesto varias opciones atractivas, se plantea la necesidad de aplicar un análisis multicriterio que nos permita tomar una decisión objetiva y equilibrada.

El objetivo del presente estudio es determinar cuál es el destino más adecuado para el viaje de fin de carrera utilizando distintas metodologías de decisión multicriterio implementadas en R.

Las alternativas consideradas son las siguientes:

1.  Viaje al Caribe en un resort con todo incluido
2.  Recorrido por España visitando las principales ciudades (Madrid, Barcelona, Valencia, etc.).
3.  Viaje a la India con la finalidad de realizar un voluntariado social y cultural.
4.  Viaje al Sudeste Asiático, recorriendo países como Indonesia, Vietnam o Camboya.
5.  Crucero por las Islas Griegas, con paradas en diferentes destinos turísticos del Mediterráneo.
6.  Interrail por Europa, visitando varias capitales y grandes ciudades europeas.

Para evaluar estas alternativas, hemos establecido cinco criterios de decisión que reflejan los aspectos más relevantes a considerar en la elección del destino:

1.  Costo total del viaje (C1): incluye transporte, alojamiento y actividades. Este criterio debe minimizarse, ya que un menor costo es preferible.

2.  Nivel de organización requerida (C2): mide la facilidad logística del viaje (coordinación, reservas, visados, etc.) teniendo en cuenta que somos un grupo de 20 personas. También se debe minimizar, porque un viaje más fácil de organizar es más conveniente.

3.  Experiencia cultural y conexión con la naturaleza (C3): evalúa el grado en que el destino permite un aprendizaje cultural significativo y una inmersión en entornos naturales únicos. Este criterio considera tanto las oportunidades de interacción con diferentes culturas, tradiciones y formas de vida, como la posibilidad de disfrutar y valorar la naturaleza. Este criterio se maximiza, ya que se valora positivamente un destino que combine cultura y naturaleza de manera enriquecedora.

4.  Diversión y ocio (C4): refleja las oportunidades de entretenimiento, descanso y actividades recreativas disponibles. Se maximiza.

5.  Este criterio evalúa el nivel general de seguridad que ofrece cada destino, tanto desde el punto de vista sanitario como social o político. Dado que un entorno seguro contribuye positivamente a la experiencia del viaje, este criterio se maximiza.

    Para lograr una valoración más detallada, el criterio se descompone en los siguientes subcriterios:

    -   C5.1 Seguridad sanitaria: analiza el acceso a servicios de salud, las condiciones higiénico-sanitarias del destino y la existencia de riesgos sanitarios (enfermedades endémicas, vacunación requerida, calidad del agua, etc.).

    -   C5.2 Seguridad sociopolítica: evalúa la estabilidad del país o región, el nivel de delincuencia, la seguridad ciudadana y la presencia de posibles conflictos o disturbios.

    Ambos subcriterios se consideran relevantes para la elección final, y al ser aspectos que aportan valor al bienestar y tranquilidad del grupo, se maximizan.

```{r}
# Comenzamos cargando las librerías necesarias
source("teoriadecision_funciones_multicriterio.R")
source("https://raw.githubusercontent.com/calote/TDecisionCodigo/refs/heads/master/teoriadecision_funciones_multicriterio_diagram.R")
source("https://raw.githubusercontent.com/calote/TDecisionCodigo/refs/heads/master/teoriadecision_funciones_multicriterio_utiles.R")

library(kableExtra)
```

### MÉTODO AHP

```{r}
library(ahp)
#ahp::RunGUI()

library(formattable)

datos = Load("ModeloTrabajo02.ahp") # archivo con la estructura del problema
Calculate(datos) # Calcular las prioridades
Visualize(datos) # Visualizar la jerarquia
# AnalyzeTable(datos) # Analizar
# AnalyzeTable(datos, variable = "priority") # Analizar con la otra tabla 

# Lo he dejado comentado porque me daban problemas al hacer la salida a pdf, por tanto exporto foto del resultado:
# Para exportar una "foto" de la tabla
export_formattable(AnalyzeTable(datos), file = "tabla.png")
export_formattable(AnalyzeTable(datos, variable = "priority"), file = "tablaPriority.png")
```

#### CONCLUSIÓN

De acuerdo con los resultados obtenidos observamos que **según el método AHP el destino** **más adecuado para el viaje de fin de carrera es España**, con un peso global del 25,9%, seguido de Interrail (19,4%) e Islas Griegas (18,2%).

El criterio con mayor importancia global es el costo (38,7 %), lo cual refleja que el factor económico será el más determinante en la elección. Le siguen cultura-naturaleza (21,2 %) y diversión (21,2 %), mostrando que los aspectos de experiencia cultural y ocio también tienen un peso significativo. Por el contrario, los criterios seguridad (11,9 %) y organización (6,9 %) tienen menor influencia en la decisión final.

Observamos que el criterio de Seguridad estaba dividio en dos subcriterios, pues, la seguridad socio política (66.7%) es dos veces más importante que la seguridad sanitaria (33.3%)

En cuanto al desempeño por criterio:

-   España destaca especialmente en los criterios de costo, seguridad y organización, lo que explica su posición como la mejor alternativa global.

-   Interrail y Islas Griegas logran buenas valoraciones equilibradas, aunque sin sobresalir tanto.

-   India y Sudeste Asiático obtienen puntuaciones altas en cultura y naturaleza, pero su mayor costo y la menor seguridad reducen su posición global.

-   Caribe también ofrece un buen equilibrio entre diversión y cultura, pero su elevado costo lo penaliza en el resultado total.

Los valores de inconsistencia son bajos (entre 0,4 % y 5,3 %), lo que indica que las comparaciones realizadas son coherentes y consistentes con la lógica del modelo AHP.

A partir de este punto, se emplearán los pesos globales obtenidos mediante el método AHP para continuar con el análisis multicriterio.

### MÉTODO ELECTRE

Comenzamos definiendo la matriz y los pesos. Recuerda que como el coste queríamos minimizarlo debemos de cambiarle el signo a los datos correspondientes.

```{r}
p = multicriterio.crea.matrizdecision(c(
-4000, -4, 2, 5, 6, # Caribe
-500, -3, 3, 3, 9, # España
-2200, -1, 5, 2, 3, # India
-3000, -1, 5, 2, 4, # Sudeste Asiático
-1800, -2, 4, 4, 8, # Crucero Islas Griegas
-1500, -2, 4, 5, 9 # Interrail
), numalternativas = 6, numcriterios = 5,
v.nombresalt = c("Caribe", "España", "India", "Sudeste Asiático", "Islas Griegas", "Interrail"),
v.nombrescri = c("Costo", "Organización", "Cultura-Naturaleza", "Diversión", "Seguridad"))
p

pesos=c(0.388,0.212,0.212,0.119,0.069)
# sum(pesos) (compruebo que sumen 1)
```

```{r}
alfa0=0.7 
electre0 = multicriterio.metodoELECTRE_I(p,pesos.criterios=pesos, 
                                        nivel.concordancia.minimo.alpha = alfa0, 
                                        no.se.compensan = c(1500,Inf,4,Inf,8), 
                                        que.alternativas = TRUE)
names(electre0)
electre0$relacion.dominante
```

```{r}
qgraph::qgraph(electre0$relacion.dominante) 
electre0$nucleo_aprox
```

Observamos que tenemos tres elementos en el núcleo, por ello vamos a intentar ver qué obtenemos cambiando el valor de alfa

```{r}
alfa=0.55 
electre = multicriterio.metodoELECTRE_I(p,pesos.criterios=pesos, 
                                        nivel.concordancia.minimo.alpha = alfa, 
                                        no.se.compensan = c(1500,Inf,4,Inf,8), 
                                        que.alternativas = c(2,3,6))
names(electre)
electre$relacion.dominante
```

```{r}
qgraph::qgraph(electre$relacion.dominante) 
electre$nucleo_aprox
```

#### CONCLUSIÓN

De acuerdo con el grafo de dominancia obtenido se observa que:

-   Interrail domina a todas las demás alternativas (Caribe, India, Sudeste Asiático, Islas Griegas y España), siendo la opción con mayor dominancia global.

-   España domina a Islas Griegas, pero ambas presentan también cierta fortaleza, dominando a varias alternativas, aunque son superadas por Interrail.

-   India y Sudeste Asiático muestran un comportamiento intermedio: son dominadas por varias opciones, pero aún logran dominar al Caribe.

-   Caribe no domina a ninguna otra alternativa, lo que la posiciona como la opción más débil del conjunto.

En consecuencia, el núcleo aproximado, que recordemos que era el conjunto de alternativas no dominadas por ninguna otra, está conformado por España, pues, sobresale claramente frente a las demás.

Por tanto, **según el método ELECTRE, el Interrail se considera la mejor alternativa** para el viaje de fin de carrera, al presentar un equilibrio favorable en la mayoría de los criterios y una posición dominante respecto al resto de destinos analizados.

### MÉTODO PROMETHEE

```{r}
tabpromethee = multicriterio.crea.matrizdecision(c(-4000, -4, 2, 5, 6, # Caribe
-500, -3, 3, 3, 9, # España
-2200, -1, 5, 2, 3, # India
-3000, -1, 5, 2, 4, # Sudeste Asiático
-1800, -2, 4, 4, 8, # Crucero Islas Griegas
-1500, -2, 4, 5, 9 # Interrail
), numalternativas = 6, numcriterios=5, v.nombresalt=c('Caribe','España','India','Sudeste Asiático','Islas griegas','Interrail'), v.nombrescri=c('Coste','Organización','Cultura-Naturaleza','Ocio','Seguridad'))
tabpromethee
```

Escribimos los pesos globales obtenidos en el método AHP:

```{r}
pesos.criterios = pesos
tab.fpref = matrix(c(2,1000,1,0,
                     5, 1, 2.5, 0,
                     4, 0.5,2.5,0,
                     4, 1, 2, 0,
                     4, 0.5, 4,0), ncol=4, byrow=T)
```

#### Método Promethee I

```{r}
tab.Pthee.i = multicriterio.metodo.promethee_i(tabpromethee, pesos.criterios, tab.fpref)
tab.Pthee.i
```

##### CONCLUSIÓN

Tras aplicar el **método PROMETHEE I**, se observa que la alternativa **España** presenta el flujo entrante más alto, mientras que el flujo saliente más bajo corresponde a **Interrail**. Esto implica que Interrail es preferida frente a todas las demás alternativas, salvo España, con la cual resulta incomparable, dado que ambas muestran un equilibrio entre sus capacidades de dominar y ser dominadas.

Por su parte, España también es incomparable con Islas Griegas, ya que esta última presenta un flujo saliente menor.

La alternativa Islas Griegas se muestra preferida a India, Caribe y Sudeste Asiático, al superarles tanto en su capacidad de dominancia como en menor grado de ser dominada.

A continuación, se observa que India domina a Sudeste Asiático y al Caribe. Y finalmente, Sudeste Asiático domina al Caribe.

Por ello, el Caribe se sitúa como la alternativa menos favorable del conjunto analizado.

No obstante, veamos el método Promethee II que es quien me va a permitir ordenar de forma total las alternativas:

#### Método Promethee II

```{r}
tab.Pthee.ii = multicriterio.metodo.promethee_ii(tabpromethee, pesos.criterios, tab.fpref)
tab.Pthee.ii
```

```{r}
order(tab.Pthee.ii$vflujos.netos, decreasing=T)
```

##### CONCLUSIÓN

**Con el método Promethee II concluimos que Interrail sería la alternativa preferida** (al ser la de mayor flujo neto), seguida de las España, Islas Griegas, India, Sudeste Asiático, y por último, el Caribe.

El orden es:

Interrail\> España\> Islas Griegas \> India \> Sudeste Asiático \> Caribe

### MÉTODO AXIOMÁTICO DE ARROW Y RAYMOND

```{r}
sejarrow = multicriterio.metodoaxiomatico.ArrowRaymond(p)
sejarrow
```

```{r}
sejarrow$alternativasordenadas
```

#### Análisis paramétrico o de sensibilidad aplicación Método axiomático de Arrow y Raymond

Estudiamos cómo cambian las ordenaciones de las alternativas para los distintos valores de alfa:
